<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>报表</title>
    <link rel="stylesheet" href="../css/bootstrap.min.css" />
    <script src="../js/adapter.js"></script> <!--rem适配js-->

    <link rel="stylesheet" href="../css/base.css"> <!--初始化文件-->
    <link rel="stylesheet" href="../css/menu.css"> <!--主样式-->
    <link rel="stylesheet" href="../css/bootstrap-datetimepicker.min.css">

    <script type="text/javascript" src="../js/jquery.min.js" ></script>
    <script type="text/javascript" src="../js/bootstrap.min.js" ></script>
    <script type="text/javascript" src="../js/ichart.1.2.1.min.js" ></script>
    <script type="text/javascript" src="../js/bootstrap-datetimepicker.fr.js" ></script>
    <script type="text/javascript" src="../js/bootstrap-datetimepicker.js" ></script>
    <script type="text/javascript" src="../js/bootstrap-datetimepicker.zh-CN.js" ></script>
    <style>
        .home-report-1{
            border:1px solid steelblue;
            height: 300px;
            width: 55%;
            float: left;
            margin-left: 2.5%;
            margin-top: 15px;
        }
        .home-report-2{
            border:1px solid steelblue;
            height: 300px;
            width: 20%;
            float: left;
            margin-left: 2%;
            margin-top: 15px;
        }
        .home-report-3{
            border:1px solid steelblue;
            height: 300px;
            width: 55%;
            float: left;
            margin-left: 2.5%;
            margin-top: 15px;
        }
        .home-report-4{
            border:1px solid steelblue;
            height: 300px;
            width: 20%;
            float: left;
            margin-left: 2%;
            margin-top: 15px;
        }
        /**用户使用量报表-------begin**/
        .user-report{
            margin-top: 15px;
            margin-left: 2%;
            width:75%;
            height:600px;
            border:solid steelblue 2px;
            position:relative;
            float: left;
        }
        .title{
            width:140px;
            height:25px;
            position:absolute;
            top:-12px;
            left:100px;
            background-color:#ffffff;
            line-height:25px;
            text-align:center;
            font-family: 微软雅黑;
            font-size: 20px;
            font-weight:bold;
        }
        .user-report-condition{
            margin-top: 20px;
        }
        input{
            border: #4cae4c 1px solid;
            width: 15%;
            height: 30px;
        }
        .condition-list{
            margin-left: 5%;
            margin-top: 40px;
        }
        button{
            width: 80px;
            height: 30px;
        }
        .userCanvasDiv{
            margin-top: 40px;
        }
        /**用户使用量报表-------end**/


    </style>
</head>
<body>

<div id="menu">
    <!--隐藏菜单-->
    <div id="ensconce">
        <h2>
            <img src="../img/show.png" alt="">
            报表管理
        </h2>
    </div>

    <!--显示菜单-->
    <div id="open">
        <div class="navH">
            报表管理
            <!--<span><img class="obscure" src="../img/obscure.png" alt=""></span>-->
        </div>
        <div class="navBox">
            <ul>
                <li>
                    <h2 class="obtain">离线报表<i></i></h2>
                    <div class="secondary">
                        <h3 id="user-num">用户使用量</h3>
                       <!-- <h3 id="">推送点击量</h3>-->
                        <h3 id="page-num">页面访问量</h3>
                       <!-- <h3>功能访问量</h3>
                        <h3>城市用户量</h3>-->
                    </div>
                </li>
                <li>
                    <h2 class="obtain">实时报表<i></i></h2>
                    <div class="secondary">
                        <h3 id="cityUs-num">城市使用量</h3>
                       <!-- <h3>模块点击量</h3>-->
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>

<script src="../js/menu.js"></script> <!--控制js-->

<div class="home-report">
    <div class="home-report-1">
        <div id="canvasDiv-1"></div>
    </div>
    <div class="home-report-2" style="text-align: center;padding-top: 100px">
        功能介绍</br>
        按月统计的2018年app用户注册量</br>
        柱状图表,直观的展示了每月注册</br>
        的用户数量。
    </div>
    <div class="home-report-3">
        <div id="canvasDiv-2"></div>
    </div>
    <div class="home-report-4" style="text-align: center;padding-top: 100px">
        功能介绍</br>
        按年龄段统计的2018年用户注册量</br>
        环型图直观的提现出每个年龄阶段</br>
        用户的注册数量。
    </div>
</div>

<div class="user-report" style="display:none" id="user-report">
    <div class="title">用户使用量报表</div>
    <div class="user-report-condition">
        <div class="condition-list">
            <span>开始时间:</span>&nbsp;&nbsp;&nbsp;<input class="datetimepicker" id="startTime" name="startTime" placeholder="选择开始时间"/>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <span>结束时间:</span>&nbsp;&nbsp;&nbsp;<input class="datetimepicker" id="endTime" name="endTime" placeholder="选择结束时间"/>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button type="button"  id="btn-user-query" class="btn-success btn-query">查询</button>
            <button type="button"  id="btn-user-reset" class="btn-warning btn-reset">重置</button>
        </div>
    </div>
    <div class="user-report-1">
        <div class="userCanvasDiv" id="userCanvasDiv-1"></div>
    </div>
</div>


<div class="user-report" style="display:none" id="page-report">
    <div class="title">页面点击量报表</div>
    <div class="user-report-condition">
        <div class="condition-list">
            <span>开始时间:</span>&nbsp;&nbsp;&nbsp;<input class="datetimepicker" id="pagestartTime" name="pagestartTime" placeholder="选择开始时间"/>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <span>结束时间:</span>&nbsp;&nbsp;&nbsp;<input class="datetimepicker" id="pageendTime" name="pageendTime" placeholder="选择结束时间"/>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button type="button"  id="btn-page-query" class="btn-success btn-query">查询</button>
            <button type="button"  id="btn-page-reset" class="btn-warning btn-reset">重置</button>
        </div>
    </div>
    <div class="page-report-1">
        <div class="userCanvasDiv" id="userCanvasDiv-2"></div>
    </div>
</div>


<div class="user-report" style="display:none" id="cityUs-report">
    <div class="title">城市使用量报表</div>

    <div class="page-report-1">
        <div class="userCanvasDiv" id="userCanvasDiv-3"></div>
    </div>
</div>

<!--报表script-->
<script>
    //定义数据
    var data = [
        {name : '1',value : 7,color:'#a5c2d5'},
        {name : '2',value : 5,color:'#cbab4f'},
        {name : '3',value : 12,color:'#76a871'},
        {name : '4',value : 12,color:'#76a871'},
        {name : '5',value : 15,color:'#a56f8f'},
        {name : '6',value : 13,color:'#c12c44'},
        {name : '7',value : 15,color:'#a56f8f'},
        {name : '8',value : 18,color:'#9f7961'},
        {name : '9',value : 12,color:'#76a871'},
        {name : '10',value : 4,color:'#6f83a5'}
    ];
    $(function(){
        var chart = new iChart.Column2D({
            render : 'canvasDiv-1',//渲染的Dom目标,canvasDiv为Dom的ID
            data: data,//绑定数据
            title : '2018年度月注册数量',//设置标题
            width : 700,//设置宽度，默认单位为px
            height : 290,//设置高度，默认单位为px
            shadow:true,//激活阴影
            shadow_color:'#c7c7c7',//设置阴影颜色
            coordinate:{//配置自定义坐标轴
                scale:[{//配置自定义值轴
                    position:'left',//配置左值轴
                    start_scale:0,//设置开始刻度为0
                    end_scale:20,//设置结束刻度为26
                    scale_space:4,//设置刻度间距
                    listeners:{//配置事件
                        parseText:function(t,x,y){//设置解析值轴文本
                            return {text:t+" 万人"}
                        }
                    }
                }]
            }
        });
        //调用绘图方法开始绘图
        chart.draw();
    });

    $(function(){
        var data = [
            {name : '21-25岁',value : 30,color:'#fedd74'},
            {name : '16-20岁',value : 25,color:'#82d8ef'},
            {name : '26-30岁',value : 15,color:'#f76864'},
            {name : '31-35岁',value : 20,color:'#80bd91'},
            {name : '36-40岁',value : 10,color:'#fd9fc1'}
        ];

        var chart = new iChart.Donut2D({
            render : 'canvasDiv-2',
            center:{
                text:'年龄段占比',
                shadow:true,
                shadow_offsetx:0,
                shadow_offsety:2,
                shadow_blur:2,
                shadow_color:'#b7b7b7',
                color:'#6f6f6f'
            },
            data: data,
            offsetx:-60,
            shadow:true,
            /*background_color:'#f4f4f4',*/
            separate_angle:10,//分离角度
            tip:{
                enable:true,
                showType:'fixed'
            },
            legend : {
                enable : true,
                shadow:true,
                background_color:null,
                border:false,
                legend_space:30,//图例间距
                line_height:34,//设置行高
                sign_space:10,//小图标与文本间距
                sign_size:30,//小图标大小
                color:'#6f6f6f',
                fontsize:30//文本大小
            },
            sub_option:{
                label:false,
                color_factor : 0.3
            },
            showpercent:true,
            decimalsnum:2,
            width : 700,
            height : 290,
            radius:140
        });

        /**
         *利用自定义组件构造左侧说明文本。
         */
        chart.plugin(new iChart.Custom({
            drawFn:function(){
                /**
                 *计算位置
                 */
                var y = chart.get('originy');
                /**
                 *在左侧的位置，设置竖排模式渲染文字。
                 */
                chart.target.textAlign('center')
                    .textBaseline('middle')
                    .textFont('600 24px 微软雅黑')
                    .fillText('各年龄段注册占比',100,y,false,'#6d869f', 'tb',26,false,0,'middle');

            }
        }));
        chart.draw();

    });

    /**用户使用量报表**/
    $("#user-num").click(function () {
        $("#page-report").attr("style","display:none");
        $(".home-report").attr("style","display:none");
        $("#cityUs-report").attr("style","display:none");
        $("#user-report").attr("style","display:");
    });

    //ajax发送请求
    $("#btn-user-query").click(function () {
        $.ajax({
            type:"POST",
            url:"/report/userUs",
            data:{"startTime":$("#startTime").val(),"endTime":$("#endTime").val()},
            success:function (data) {
                userUs(JSON.parse(data),"userCanvasDiv-1","用户使用量报表");
            }
        });
    });
    function userUs(data,model,tiitle) {
        var chart = new iChart.Column2D({
            render : model,//渲染的Dom目标,canvasDiv为Dom的ID
            data: data,//绑定数据
            title : tiitle,//设置标题
            width : 1000,//设置宽度，默认单位为px
            height : 400,//设置高度，默认单位为px
            shadow:true,//激活阴影
            shadow_color:'#c7c7c7',//设置阴影颜色
            coordinate:{//配置自定义坐标轴
                scale:[{//配置自定义值轴
                    position:'left',//配置左值轴
                    start_scale:0,//设置开始刻度为0
                    end_scale:20,//设置结束刻度为26
                    scale_space:4,//设置刻度间距
                    listeners:{//配置事件
                        parseText:function(t,x,y){//设置解析值轴文本
                            return {text:t+" 万人"}
                        }
                    }
                }]
            }
        });
        //调用绘图方法开始绘图
        chart.draw();
    }

    $("#startTime").datetimepicker({
        format: 'yyyy-mm-dd',//显示格式
        todayHighlight: 1,//今天高亮
        minView: "month",//设置只显示到月份
        startView:2,
        forceParse: 0,
        showMeridian: 1,
        autoclose: 1,//选择后自动关闭
        language:'zh-CN'
    });
    $("#endTime").datetimepicker({
        format: 'yyyy-mm-dd',//显示格式
        todayHighlight: 1,//今天高亮
        minView: "month",//设置只显示到月份
        startView:2,
        forceParse: 0,
        showMeridian: 1,
        autoclose: 1,//选择后自动关闭
        language:'zh-CN'
    });

    /*页面点击量*/
    /**用户使用量报表**/
    $("#page-num").click(function () {
        $(".home-report").attr("style","display:none");
        $("#user-report").attr("style","display:none");
        $("#cityUs-report").attr("style","display:none");
        $("#page-report").attr("style","display:");
    });
    $("#pagestartTime").datetimepicker({
        format: 'yyyy-mm-dd',//显示格式
        todayHighlight: 1,//今天高亮
        minView: "month",//设置只显示到月份
        startView:2,
        forceParse: 0,
        showMeridian: 1,
        autoclose: 1,//选择后自动关闭
        language:'zh-CN'
    });
    $("#pageendTime").datetimepicker({
        format: 'yyyy-mm-dd',//显示格式
        todayHighlight: 1,//今天高亮
        minView: "month",//设置只显示到月份
        startView:2,
        forceParse: 0,
        showMeridian: 1,
        autoclose: 1,//选择后自动关闭
        language:'zh-CN'
    });
    $("#btn-page-query").click(function () {
        $.ajax({
            type:"POST",
            url:"/report/pageUs",
            data:{"startTime":$("#startTime").val(),"endTime":$("#endTime").val()},
            success:function (data) {
                userUs(JSON.parse(data),"userCanvasDiv-2","页面点击量报表");
            }
        });
    });

    /*城市使用量实时报表*/

    $("#cityUs-num").click(function () {
        $(".home-report").attr("style","display:none");
        $("#user-report").attr("style","display:none");
        $("#page-report").attr("style","display:none");
        $("#cityUs-report").attr("style","display:");
        $.ajax({
            type:"POST",
            url:"/city/cityInfo",
            data:{},
            success:function (data) {
                userUs(JSON.parse(data),"userCanvasDiv-3","城市实时报表");
            }
        });
    });
</script>
</body>
</html>